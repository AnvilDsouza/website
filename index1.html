<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Anvil D'Souza — Director's Office (Virtual)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  
  <!-- A-Frame (single dependency) -->
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  
  <style>
    html,body { height:100%; margin:0; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial; font-weight:bold; background:#111;}
    #ui-speech {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 20px;
      background: rgba(0,0,0,0.6);
      color: #fff;
      padding: 10px 14px;
      border-radius: 10px;
      font-size: 16px;
      z-index: 9999;
      max-width: 90%;
      text-align: center;
      box-shadow: 0 8px 18px rgba(0,0,0,0.6);
    }
    .hint {
      position: fixed; left: 14px; bottom: 14px; background: rgba(255,255,255,0.06); color: #fff; padding:6px 10px; border-radius:999px; font-size:13px; z-index:9998;
    }
    /* Modal-like reader for external links */
    #linkModal {
      position: fixed; inset:6%; display:none; z-index:10000; background: rgba(0,0,0,0.95); border-radius:12px; overflow:hidden;
    }
    #linkModal header { display:flex; justify-content:space-between; align-items:center; padding:10px 14px; color:#fff; background:rgba(255,255,255,0.03); font-weight:600; }
    #linkModal iframe { width:100%; height: calc(100% - 52px); border:0; display:block; }
    #linkModal button { background: #222; color:#fff; border:1px solid rgba(255,255,255,0.06); padding:6px 10px; border-radius:8px; cursor:pointer; }
  </style>
  
</head>
<body>
  <!-- UI -->
  <div id="ui-speech">Loading the Director’s Office...</div>
  <div class="hint">Drag to look • WASD to move • Click highlighted guides</div>

  <!-- Modal to open external pages (CV / LinkedIn / Comics) -->
  <div id="linkModal" role="dialog" aria-hidden="true">
    <header>
      <div id="linkTitle">External link</div>
      <div><button id="closeLink">Close ✕</button></div>
    </header>
    <iframe id="linkFrame" src=""></iframe>
  </div>

  <!-- A-Frame scene (background="color: #22242a" embedded) -->
  <a-scene>

    <!-- 360° Office Background -->
    <a-sky src="modern-office.jpg" rotation="0 -90 0"></a-sky>
    
    <!-- Ambient lighting -->
    <a-entity light="type: ambient; intensity: 0.9"></a-entity>
    <a-entity light="type: directional; intensity: 0.6" position="-1 3 2"></a-entity>

    <!-- Floor and back wall for an office vibe 
    <a-plane rotation="-90 0 0" width="40" height="40" color="#1d1f22"></a-plane>
    <a-box position="0 1.6 -6" width="10" height="3.6" depth="0.3" color="#2b3136"></a-box> -->

    <!-- Desk 
    <a-box position="0 0.85 -3" width="3.6" height="0.8" depth="1.4" color="#5b3a21"></a-box>
    <!-- laptop placeholder <a-box position="-1.5 0.4 -2.1" width="0.3" height="0.3" depth="0.3" color="#999"></a-box>  -->

    <!-- Chair and simple seated avatar (group of primitives to avoid external models) 
    <a-cylinder position="0 0.4 -2.9" radius="0.35" height="0.1" color="#222"></a-cylinder>
    <!-- body 
    <a-sphere id="head" position="0 1.45 -2.6" radius="0.18" color="#f1c27d"></a-sphere>
    <a-box id="torso" position="0 1.05 -2.6" width="0.5" height="0.6" depth="0.3" color="#1a73e8"></a-box>
    <!-- subtle idle animation on the head 
    <a-animation attribute="rotation" to="0 6 0" dur="2200" direction="alternate" repeat="indefinite" easing="ease-in-out"></a-animation> -->

    <!-- Nameplate 
    <a-plane position="0 0.42 -2.1" width="0.9" height="0.18" color="#0b0b0b" rotation="-10 0 0">
      <a-text value="Anvil D'Souza — Director, AI & Product" color="#fff" align="center" width="1.6" position="0 0 0.01"></a-text>
    </a-plane> -->

    <a-assets>
      <a-asset-item id="laptop" src="laptop.glb"></a-asset-item>
      <a-asset-item id="golden_trophy" src="golden_trophy.glb"></a-asset-item>
      <a-asset-item id="book" src="book.glb"></a-asset-item>
    </a-assets>
    <a-text id="hot_about" value="About" position="-5 0 -3" color="#fff" align="center"></a-text>
    <a-entity gltf-model="#laptop" position="-7 -3 -7" scale="1 1 1" rotation="0 90 0"></a-entity>
    
    <a-text id="hot_achievements" value="Achievements" position="-2.5 2.5 -3.5" color="#fff" align="center"></a-text>
    <a-entity gltf-model="#golden_trophy" position="-200 -1 -450"></a-entity>

    <a-text id="hot_contributions" value="Contributions" position="-9 -3 -3.5" rotation="0 90 0" color="#fff" align="center"></a-text> 
    <a-entity gltf-model="#book" position="-10 -4 -4" scale="8 8 8"></a-entity>

    <!-- Three interactive guide spheres (hotspots). They are slightly emissive and pulse 
    <a-sphere id="hot_about" class="nav" position="-6 -1 -3" radius="0.18" color="#00b5ff" emissive="#00b5ff" emissiveIntensity="0.7">
      <a-animation attribute="scale" dur="1200" to="1.2 1.2 1.2" direction="alternate" repeat="indefinite"></a-animation>
    </a-sphere> 
    <a-sphere id="hot_awards" class="nav" position="-4.5 -1 -3.5" radius="0.18" color="#ffb300" emissive="#ffb300" emissiveIntensity="0.6">
      <a-animation attribute="scale" dur="1400" to="1.18 1.18 1.18" direction="alternate" repeat="indefinite"></a-animation>
    </a-sphere> 
    <a-sphere id="hot_bookshelf" class="nav" position="-3 -1 -4" radius="0.18" color="#7be57a" emissive="#7be57a" emissiveIntensity="0.6">
      <a-animation attribute="scale" dur="1100" to="1.15 1.15 1.15" direction="alternate" repeat="indefinite"></a-animation>
    </a-sphere> -->

    <!-- Camera + cursor: mouse + WASD support -->
    <a-entity id="rig" position="0 1.6 2">
      <a-entity camera look-controls wasd-controls>
        <a-entity cursor="fuse: false; rayOrigin: mouse" raycaster="objects: .nav, .clickable" geometry="primitive:ring; radiusInner:0.005; radiusOuter:0.01" material="color: #fff; shader: flat"></a-entity>
      </a-entity>
    </a-entity>
  </a-scene>

  <script>
    // Simple script to orchestrate speech, highlighting and modal navigation.
    function speak(text) {
      const msg = new SpeechSynthesisUtterance(text);
      msg.rate = 1; 
      msg.pitch = 1; 
      msg.voice = speechSynthesis.getVoices().find(v => v.lang.includes('en'));
      speechSynthesis.speak(msg);
    }
    
    const speechEl = document.getElementById('ui-speech');
    let step = 0;

    const dialogues = [
      "Hello — welcome to Anvil D'Souza's virtual director's office. I'm the AI PM — your guide.",
      "I lead product & AI teams that build regulated, revenue-first systems. Let me show you three key areas.",
      "To the left: About — learn about Anvil and download the CV. In the middle: Awards — explore project recognitions. To the right: Bookshelf — read newsletters & comics."
    ];

    function runDialogue(i=0) {
      if (i >= dialogues.length) return;
      speechEl.textContent = dialogues[i];
      speak(dialogues[i]);
      setTimeout(() => runDialogue(i+1), 4200);
    }
    window.onload = () => {
      runDialogue();
    };

    // Modal handling
    const linkModal = document.getElementById('linkModal');
    const linkFrame = document.getElementById('linkFrame');
    const linkTitle = document.getElementById('linkTitle');
    document.getElementById('closeLink').addEventListener('click', closeModal);

    function openModal(title, url) {
      linkTitle.textContent = title;
      // Start timeout fallback in case site blocks embedding
      linkFrame.src = url;
      linkModal.style.display = 'block';
      linkModal.setAttribute('aria-hidden', 'false');
      // fallback: if not loaded in 2200ms, open in new tab and close modal
      const t = setTimeout(() => { window.open(url, '_blank', 'noopener'); closeModal(); }, 2200);
      linkFrame.onload = () => clearTimeout(t);
    }
    function closeModal() {
      linkFrame.src = '';
      linkModal.style.display = 'none';
      linkModal.setAttribute('aria-hidden', 'true');
    }

    // Hotspot click behaviours (About / Awards / Bookshelf)
    const about = document.getElementById('hot_about');
    const achievements = document.getElementById('hot_achievements');
    const contributions = document.getElementById('hot_contributions');

    about.addEventListener('click', () => {
      // change speech text and open LinkedIn/CV choices via modal links
      speechEl.innerHTML = "About: Visit my <a href='#' id='linkedIn' target='_blank' style='color:#9fdcff'>LinkedIn</a> or <a href='#' id='cvLink' style='color:#9fdcff'>download my CV</a>.";
      // wire CV link to modal — set your CV URL below
      setTimeout(() => {
        const cv = document.getElementById('linkedIn');
        if (cv) {
          cv.addEventListener('click', (e) => { e.preventDefault(); openModal('LinkedIn Profile', 'https://www.linkedin.com/in/anvildsouza'); });
        }
      }, 80);
      
      // wire CV link to modal — set your CV URL below
      setTimeout(() => {
        const cv = document.getElementById('cvLink');
        if (cv) {
          cv.addEventListener('click', (e) => { e.preventDefault(); openModal('Download CV', 'CV Anvil DSouza.pdf'); });
        }
      }, 80);
    });

    achievements.addEventListener('click', () => {
      speechEl.innerHTML = "Achievements: Click trophies (coming soon) to view project pages and award details. For now, open the awards overview.";
      // open a placeholder awards page
      setTimeout(() => openModal('AI PM Newsletter', 'https://www.linkedin.com/build-relation/newsletter-follow?entityUrn=7327570817578352640'), 900);
    });

    contributions.addEventListener('click', () => {
      speechEl.innerHTML = "Contributions: Explore the AI PM Newsletter and AI PM Comics. Opening the bookshelf...";
      // connect to the bookshelf page you already host (replace below with your shelf host)
      setTimeout(() => openModal('AI PM Series', 'https://gemini.google.com/share/233d69d38d80'), 900);
    });

    // Basic accessibility: close modal with Escape
    window.addEventListener('keydown', (ev) => {
      if (ev.key === 'Escape') closeModal();
    });

    // Quick console note
    console.info('Director Office scene ready. If the scene does not render, check browser console for errors (Press F12).');
  </script>
</body>
</html>
